# RESTAPI

생성일: 2021년 8월 21일 오후 5:59

# JSON Response basic format

```json
//성공시
{
    "message":"sucess",
    "status":"200",
    "data":{}
}
// 잘못된 접근 또는 validation 
{
  "message":"무슨 에러입니다.",
	"httpStatus": 400,
	"data":{
		"message":"잘못된 접근 입니다."
	}
}
```

# RESTAPI

## PHP

도메인 주소 명 , 데이터 베이스 명 변경_ **시스템콜활용
-** 사용자와 관리자가 공통으로 사용하는 코드이며 범용성있게 작성

### Spring-boot

/api

/student - **개발 중점이 아니기때문에 수정 제외하고는 명시하지 않는다.**

**POST /
계정 생성 완료
생성시 admin hashcode를 조회후 성공시 저장**
학생 계정 생성 후 생성된 학생 , 사이트 정보 제공

```json
//requestBody
{
    "name":"",
    "studentCode":"",
    "password":"",
    "phoneNumber":"",
    "email":"",
    "hashCode":""
}
//return
{
    "message":"계정 생성",
    "status":"200",
    "data":{
            "id":1,
            "name":"",
            "studentCode":"",
            "password":"",
            "phoneNumber":"",
            "email":"",
            "inSchool":true,
            "isDeleted":false,
            "siteInfo":{
                "domainName":"",
                "databaseName":""
            }
    }

```

**GET ?studentCode=&name=**
**계정 찾기**
이름 학번 통해 계정 찾은 후 학생 , 사이트 정보 제공

```json
//PathParam
//return
{
    "message":"계정 조회 성공",
    "status":"200",
    "data":{
            "id":1,
            "name":"",
            "studentCode":"",
            "password":"",
            "phoneNumber":"",
            "email":"",
            "inSchool":true,
            "isDeleted":false,
            "siteInfo":{
                "domainName":"",
                "databaseName":""
            }
    }
}
```

**POST /login**
**로그인**
학번 비밀 번호를 통해 로그인후 학생 , 사이트 정보 제공

```json
//requestBody
{
    "studentCode":"",
    "password":""
}
//return
{
    "message":"로그인 성공",
    "status":"200",
    "data":{
            "id":1,
            "name":"",
            "studentCode":"",
            "password":"",
            "phoneNumber":"",
            "email":"",
            "inSchool":true,
            "isDeleted":false,
            "siteInfo":{
                "domainName":"",
                "databaseName":""
            }
    }
}
```

**POST /logout**
**로그아웃**
세션을 통해 학생 로그아웃 간단한 메세지 제공

```json
{
    "message":"로그아웃",
    "status":"200"
}
```

**GET /studentcode?name=&stduentCode=**
**학번 확인**
계정 생성전 멀티과 여부 파악을 위해 학번 이름 조회

```json
//RequestParam
//return
{
    "message":"학번 조회 성공",
    "status":"200",
    "data":{
            "name":"",
            "studentCode":""
    }
}
```

**POST /modify**
**정보 수정(단일)**
학생 , 사이트 정보를 학생 정보 수정 **외부 php api 호출 방식**

```json
//requestBody
{
    "name":"",
    "password":"",
    "email":"",
    "phoneNumber":"",
    "databaseName":"",
    "domainName":"",
    "originDomain":""
}
//return 
{
    "message":"학생들 정보 입력 성공",
    "status":"200",
    "data":{
            "id":1,
            "name":"",
            "studentCode":"",
            "password":"",
            "phoneNumber":"",
            "email":"",
            "inSchool":true,
            "isDeleted":false,
            "siteInfo":{
                "domainName":"",
                "databaseName":""
            }
    }
}
```

/admin

/studentinfo

**GET /page=size=sort=**
**학생 정보 조회 Paging**
학생들 정보 조회 페이징 적용 site 정보는 여부만 파악할 수 있도록 정보 제공
참고 자료 : [https://ibks-platform.tistory.com/278](https://ibks-platform.tistory.com/278)

```json
//request param Pageable
//return
{
    "message":"학생 정보 조회 성공",
    "status":"200",
    "data":[
        {
            "id":1,
            "name":"",
            "studentCode":"",
            "password":"",
            "phoneNumber":"",
            "email":"",
            "inSchool":true,
            "isDeleted":false,
            "adminName":"hello"
        }
    ]
}
```

**GET/searchv1  검색 기능 V1**
검색 조건에 따른 학생 정보 제공 site 정보는 여부만 파악 할 수 있도록 정보 제공(조건에 따라는 select join 쿼리가 실행될 수 있도록 구현) _ 변경점이 많기 때문에 V1 선정

```json

```

GET /siteinfo/{userId}
**지정 학생 site 정보 확인**
선택한 학생의 site정보 확인

```json
// PathVariable
//return
{
    "message":"정보 확인",
    "status":"200",
    "data":{
        "domainName":"",
        "databaseName":""
    }
}
```

**POST /insert 완료**
**POST /concurrentstudents** **완료**
**동시 학생 정보 저장**
여러 학생 개인 정보 삽입 _ 엑셀 >> db 에 저장
inSchool =true , isDeleted = false 로 default로 저장

```json
//@RequestBody
[
    {
        "name":"",
        "studentCode":""
    },{
        "name":"",
        "studentCode":""
    }
]
//return
{
    "message":"학생들 정보 입력 성공",
    "status":"200"
}
```

PUT /{userIds}
**학생들 정보 수정**
복수 학생 정보 수정(도메인 정보 , database 명 수정은 php로 대체)

```json
//@RequestBody List<Req.ModifyStudent>
[
    {
				"id":1
        "name":"",
        "studentCode":"",
        "password":"",
        "phoneNumber":"",
        "email":"",
        "inSchool":true,
        "isDeleted":false,
        "siteInfo":{
            "domainName":"",
            "databaseName":""
        },
        "adminName":"hello"
    },{
				"id":1
        "name":"",
        "studentCode":"",
        "password":"",
        "phoneNumber":"",
        "email":"",
        "inSchool":true,
        "isDeleted":false,
        "siteInfo":{
            "domainName":"",
            "databaseName":""
        },
        "adminName":"hello"
    }
]
//return 
[
    {
				"id":1
        "name":"",
        "studentCode":"",
        "password":"",
        "phoneNumber":"",
        "email":"",
        "inSchool":true,
        "isDeleted":false,
        "siteInfo":{
            "domainName":"",
            "databaseName":""
        },
        "adminName":"hello"
    },{
				"id":1
        "name":"",
        "studentCode":"",
        "password":"",
        "phoneNumber":"",
        "email":"",
        "inSchool":true,
        "isDeleted":false,
        "siteInfo":{
            "domainName":"",
            "databaseName":""
        },
        "adminName":"hello"
    }
]
```

**DELETE /student/{studentId} 완료
단일 학생 정보 삭제(student테이블에서 완전히 삭제하는 것이 아니며 site정보를 완전히 날려 버리고 기존 도메인 , 데이터 베이스 삭제 요함)**

```json
//return 
{
    "message":"정보 삭제 완료",
    "status":"200"
}
```

**DELETE /students/{studentIds} 완료
복수 학생 정보 삭제**

```json
//return 
{
    "message":"정보 삭제 완료",
    "status":"200"
}
```

/rootinfo

POST **완료**
관리자 정보 수정
프론트에서 validation통해서 전달되며 부가적인 validation처리X

```json
//requestbody
{
    "name":"",
    "hashCode":"",
    "phoneNumber":"",
    "password":"password"
}
//return
{
    "message":"수정 여부",
    "status":"200",
    "data":{
        "name":"name",
        "hashCode" :"Hanscode",
        "phoneNumber" : "phoneNumber"
    }
}
```

관리자 로그인
POST /login?name=""&password="" **완료**
Exception 아이디 비밀번호 오류 , Validation 

```json
//return
{
    "message":"수정 여부",
    "status":"200",
    "data":{
        "name":"name",
        "hashCode" :"Hanscode",
        "phoneNumber" : "phoneNumber"
    }
}
```

관리자 로그아웃
POST /logout
시큐리티 이용해서 세션 제거

```json
{
    "message":"로그아웃 상태",
    "status":"200"
}
```

관리자 회원 가입
POST /signup **완료**
hashcode 생성 조건은 프론트에서 진행후 백에서도 한번 진행
Exception Validation , 존재하는 아이디 , 이메일 에러

```json
//requestBody
{
   "name":"",
   "password":"",
   "hashCode":"",
   "phoneNumber":""
}
//return
{
    "message":"회원가입 선공",
    "status":"200"
}q
```

현 관리자 정보 페이징 기반
GET /adminAll?page=""&size=""&sort=name,asc&sort=numberOfHands,desc **완료**

```json
//request Pageable
//return
{
    "message":"로그아웃 상태",
    "status":"200",
    "data":{
        "adminInfos":[
            {
                "name":"name",
                "hashCode":"",
                "phoneNumber":"",
                "createdAt":""
            }
        ],
        "page":"",
        "totalCount":"",
        "elements":""
    }
}
```

/잘못된 정보 요청시